# tiny-code-agent MVP実装タスク一覧

## 実装アプローチ
TDD（テスト駆動開発）とスケルトンファイルを用いて全体の処理フローを先に構築し、その後各機能を段階的に実装する。

## フェーズ1: 基盤構築とスケルトン実装（優先度：高）

### 基盤構築
1. **プロジェクト構造の作成**
   - `src/agent/` ディレクトリ作成
   - `src/providers/` ディレクトリ作成  
   - `src/utils/` ディレクトリ作成

2. **必要な依存関係のインストール**
   - Commander.js (CLI framework)
   - prompts (interactive prompts)
   - @anthropic-ai/sdk (Claude API)
   - neverthrow (error handling)
   - diff-match-patch (patch application)

3. **テスト環境のセットアップ**
   - Vitest設定
   - テストディレクトリ構造の作成
   - テストヘルパーの準備

### TDDによるスケルトン実装

#### ロガー機能
4. **utils/logger.ts のテスト作成**
   - 基本的なログ出力のテスト
   - ログレベルのテスト

5. **utils/logger.ts実装**
   - 基本的なコンソール出力のみ
   - テストをパスする最小限の実装

#### ツール機能
6. **agent/tools.ts のテスト作成**
   - read_fileツールのインターフェーステスト
   - apply_patchツールのインターフェーステスト

7. **agent/tools.ts実装**
   - ツールのインターフェース定義
   - モックレスポンスを返す簡易実装

#### Claude API統合
8. **providers/claude.ts のテスト作成**
   - API呼び出しインターフェーステスト
   - Function Calling形式のテスト

9. **providers/claude.ts実装**
   - Claude APIの基本的な呼び出し構造
   - モックレスポンスを返す簡易実装

#### エージェントループ
10. **agent/agent.ts のテスト作成**
    - エージェントループの基本フローテスト
    - 最大試行回数のテスト
    - 終了条件のテスト

11. **agent/agent.ts実装**
    - エージェントループの基本構造
    - テストをパスする最小限の実装

#### CLIエントリーポイント
12. **index.ts の統合テスト作成**
    - CLIコマンドのテスト
    - 全体フローの結合テスト

13. **index.ts実装**
    - Commanderによる CLI設定
    - 各モジュールの接続

14. **動作確認**
    - スケルトンコードでの一連の処理フロー実行
    - 全テストの実行と確認

## フェーズ2: 本実装（優先度：中）

### TDDによる機能実装

#### ロガー機能の完全実装
15. **utils/logger.ts のテスト拡充**
    - ファイル出力のテスト
    - ディレクトリ自動生成のテスト
    - ログローテーションのテスト

16. **utils/logger.ts本実装**
    - ファイル出力機能
    - .tiny-codeディレクトリの自動生成
    - ログレベル制御

#### ツール機能の完全実装
17. **agent/tools.ts のテスト拡充**
    - read_fileの実ファイル読み込みテスト
    - apply_patchのdiff適用テスト
    - エラーハンドリングのテスト

18. **agent/tools.ts本実装**
    - read_fileツールの完全実装
    - apply_patchツールの完全実装（diff-match-patch使用）
    - neverthrowによるエラーハンドリング

#### Claude API統合の完全実装
19. **providers/claude.ts のテスト拡充**
    - 実API呼び出しのモックテスト
    - Function Calling応答処理のテスト
    - エラーハンドリングのテスト

20. **providers/claude.ts本実装**
    - 実際のAPI呼び出し実装
    - Function Calling完全サポート
    - リトライ機能とエラーハンドリング

#### エージェントループの完全実装
21. **agent/agent.ts のテスト拡充**
    - 複雑なタスクフローのテスト
    - エラーコンテキスト管理のテスト
    - 終了判定ロジックのテスト

22. **agent/agent.ts本実装**
    - タスク実行制御の完全実装
    - エラーコンテキスト管理
    - 終了判定ロジックの実装

## フェーズ3: 品質保証（優先度：低）

23. **E2Eテストの作成と実行**
    - 実際のユースケースシナリオテスト
    - 複数のタスクパターンのテスト
    - パフォーマンステスト

## 成功指標
- 各ステップでテストが先行し、実装が後続する
- スケルトン段階で全体のアーキテクチャが確認できる
- 各フェーズが独立して動作確認可能
- コードが理解しやすく、学習目的に適している
- 全てのコードがテストでカバーされている